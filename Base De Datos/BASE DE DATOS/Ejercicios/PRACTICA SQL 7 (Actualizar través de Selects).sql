--1

UPDATE EMPLEADOS X
SET DEP_NO = (SELECT DEP_NO FROM DEPARTAMENTOS D WHERE LOCALIDAD = 'MADRID') 
WHERE DEP_NO IN (SELECT DEP_NO FROM DEPARTAMENTOS D WHERE (LOCALIDAD = 'BARCELONA' OR LOCALIDAD = 'SEVILLA'));
COMMIT;

--2

UPDATE CLIENTES X
SET DEBE =
IFNULL((SELECT SUM(PR.PRECIO_ACTUAL*P.UNIDADES) 
FROM PRODUCTOS PR JOIN PEDIDOS P 
ON PR.PRODUCTO_NO = P.PRODUCTO_NO 
GROUP BY P.CLIENTE_NO HAVING X.CLIENTE_NO = P.CLIENTE_NO), 0);
COMMIT;

--3

UPDATE EMPLEADOS X
SET SALARIO = SALARIO * 1.1
WHERE EMP_NO = 
(SELECT VENDEDOR_NO 
FROM CLIENTES C 
JOIN PEDIDOS P 
ON C.CLIENTE_NO = P.CLIENTE_NO 
GROUP BY C.CLIENTE_NO 
HAVING SUM(UNIDADES) 
ORDER BY SUM(UNIDADES) DESC 
LIMIT 1);
COMMIT;

--4

INSERT INTO CLIENTES (SELECT * FROM CLIENTESNEW);
COMMIT;

--5

UPDATE CLIENTES X
SET LIMITE_CREDITO = 
IFNULL((SELECT LIMITE_NEW 
FROM CLIENTESMOD CM 
WHERE CM.CLIENTE_NO = X.CLIENTE_NO), LIMITE_CREDITO);
COMMIT;

--6

DELETE FROM CLIENTES
WHERE CLIENTE_NO IN (SELECT C.CLIENTE_NO
FROM CLIENTESDEL C);
COMMIT;










--PRUEBAS


UPDATE CLIENTES X
SET 



















